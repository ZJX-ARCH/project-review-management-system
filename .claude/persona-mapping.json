{
  "version": "4.0.0",
  "description": "V4.0 SuperClaude Persona 角色与工作流阶段映射配置 - 支持三方对抗设计",
  "lastUpdate": "2025-11-30",

  "V4新增": {
    "三方对抗角色": {
      "Designer": {
        "model": "gemini-3.0-pro",
        "职责": "设计起草，覆盖前后端完整方案",
        "阶段": ["1.步骤1"]
      },
      "Critic": {
        "model": "gpt-5.1-codex",
        "职责": "红队攻击，找出设计漏洞和遗漏",
        "阶段": ["1.步骤2"]
      },
      "Architect": {
        "model": "claude-4.5-opus",
        "职责": "终审批准，确保质量和完整性",
        "阶段": ["1.步骤4", "P0"]
      }
    }
  },

  "personas": {
    "architect": {
      "name": "系统架构师",
      "focus": ["系统设计", "可扩展性", "技术选型", "架构决策", "三方对抗终审"],
      "workflowStages": ["P0", "1", "2"],
      "commands": ["/sc:design", "/sc:analyze --architecture"],
      "priority": "high",
      "V4角色": "在阶段1中担任Architect，进行终审批准"
    },
    "designer": {
      "name": "设计师（Gemini专属）",
      "focus": ["前后端设计", "超长上下文分析", "完整性设计", "用户体验"],
      "workflowStages": ["0", "1"],
      "commands": ["/sc:design", "/sc:spec-panel"],
      "priority": "high",
      "V4角色": "在阶段1中担任Designer，起草初始设计",
      "model": "gemini-3.0-pro"
    },
    "critic": {
      "name": "批评者（Codex专属）",
      "focus": ["代码审查", "漏洞发现", "边缘案例", "安全检查"],
      "workflowStages": ["1", "5"],
      "commands": ["/sc:improve", "/sc:reflect"],
      "priority": "high",
      "V4角色": "在阶段1中担任Critic，红队攻击设计",
      "model": "gpt-5.1-codex"
    },
    "frontend": {
      "name": "前端专家",
      "focus": ["用户体验", "React开发", "UI/UX", "前端性能"],
      "workflowStages": ["4", "6"],
      "commands": ["/sc:build --react", "/sc:build --magic"],
      "priority": "medium",
      "V4角色": "使用Gemini实现前端代码"
    },
    "backend": {
      "name": "后端专家",
      "focus": ["API开发", "数据库设计", "性能优化", "服务器端逻辑"],
      "workflowStages": ["4", "6"],
      "commands": ["/sc:build --api", "/sc:design --api"],
      "priority": "medium",
      "V4角色": "使用Codex实现后端代码"
    },
    "security": {
      "name": "安全专家",
      "focus": ["威胁建模", "安全代码", "漏洞扫描", "OWASP防护"],
      "workflowStages": ["5", "7"],
      "commands": ["/sc:analyze --security", "/sc:improve --security"],
      "priority": "high"
    },
    "analyzer": {
      "name": "分析专家",
      "focus": ["根因分析", "调试", "问题诊断", "日志分析"],
      "workflowStages": ["0", "5"],
      "commands": ["/sc:analyze", "/sc:troubleshoot"],
      "priority": "medium"
    },
    "refactorer": {
      "name": "重构专家",
      "focus": ["代码质量", "简化", "可读性", "维护性"],
      "workflowStages": ["5", "6"],
      "commands": ["/sc:improve --quality", "/sc:reflect"],
      "priority": "medium"
    },
    "performance": {
      "name": "性能专家",
      "focus": ["性能优化", "瓶颈分析", "资源使用", "响应时间"],
      "workflowStages": ["7"],
      "commands": ["/sc:improve --performance", "/sc:analyze --profile"],
      "priority": "medium"
    },
    "qa": {
      "name": "质量保证专家",
      "focus": ["测试策略", "质量控制", "缺陷预防", "验收标准"],
      "workflowStages": ["2", "5", "7"],
      "commands": ["/sc:test", "/sc:improve --quality"],
      "priority": "high"
    }
  },

  "stagePersonaMapping": {
    "P0": {
      "primary": "architect",
      "secondary": [],
      "model": "claude-4.5-opus",
      "description": "项目初始化与规划阶段，需要Opus进行系统设计",
      "V4增强": "完成后等待用户审查确认"
    },
    "0": {
      "primary": "analyzer",
      "secondary": ["designer"],
      "model": "claude-4.5-sonnet",
      "description": "需求接收与解析阶段，分析专家理解需求",
      "V4增强": "Gemini可用于超长上下文需求分析"
    },
    "1": {
      "primary": "三方对抗",
      "secondary": [],
      "description": "V4三方对抗设计：Designer(Gemini) → Critic(Codex) → Architect(Opus)",
      "V4流程": {
        "步骤1": {
          "persona": "designer",
          "model": "gemini-3.0-pro",
          "任务": "设计初稿"
        },
        "步骤2": {
          "persona": "critic",
          "model": "gpt-5.1-codex",
          "任务": "红队攻击"
        },
        "步骤3": {
          "persona": "designer",
          "model": "gemini-3.0-pro",
          "任务": "修正设计（如需要）"
        },
        "步骤4": {
          "persona": "architect",
          "model": "claude-4.5-opus",
          "任务": "终审批准"
        }
      }
    },
    "2": {
      "primary": "architect",
      "secondary": ["qa"],
      "model": "claude-4.5-sonnet",
      "description": "任务拆解与规划阶段，架构师规划并由QA定义质量标准"
    },
    "3": {
      "primary": "dynamic",
      "secondary": [],
      "model": "claude-4.5-sonnet",
      "description": "上下文准备与交接阶段，根据任务类型动态选择角色",
      "V4增强": "强制准备交接文档"
    },
    "4": {
      "primary": "dynamic",
      "secondary": [],
      "description": "代码实现阶段，根据代码类型选择模型",
      "V4规则": [
        "前端代码（UI/组件/样式）→ gemini-3.0-pro (frontend)",
        "后端代码（API/数据库/逻辑）→ gpt-5.1-codex (backend)",
        "混合项目 → 按模块分配"
      ],
      "V4增强": "所有交接文档必须包含渐进式休眠指令"
    },
    "5": {
      "primary": "refactorer",
      "secondary": ["security", "qa"],
      "model": "claude-4.5-sonnet",
      "description": "代码审查阶段，重构专家主导，安全和QA辅助"
    },
    "6": {
      "primary": "dynamic",
      "secondary": [],
      "description": "代码修正阶段，继承阶段4的角色和模型"
    },
    "7": {
      "primary": "qa",
      "secondary": ["performance"],
      "model": "claude-4.5-sonnet",
      "description": "测试验证阶段，QA主导，性能专家辅助",
      "V4增强": "测试通过后立即进入阶段8"
    },
    "8": {
      "primary": "none",
      "secondary": [],
      "model": "claude-4.5-haiku",
      "description": "Git提交阶段，使用Haiku快速生成commit message",
      "V4增强": "立即提交，禁止堆积"
    },
    "9": {
      "primary": "dynamic",
      "secondary": [],
      "model": "claude-4.5-sonnet",
      "description": "模块交付阶段，根据模块类型总结"
    }
  },

  "commandMapping": {
    "/sc:design": {
      "workflowStages": ["P0", "1"],
      "persona": ["architect", "designer"],
      "flags": ["--api", "--ddd", "--prd", "--openapi", "--plan"],
      "description": "架构和API设计，用于阶段P0和阶段1"
    },
    "/sc:spec-panel": {
      "workflowStages": ["P0", "1"],
      "persona": "designer",
      "flags": ["--plan"],
      "description": "多专家规格审查，用于设计阶段"
    },
    "/sc:build": {
      "workflowStages": ["4"],
      "persona": ["frontend", "backend"],
      "flags": ["--react", "--api", "--init", "--feature", "--magic", "--tdd", "--coverage"],
      "description": "代码实现，用于阶段4"
    },
    "/sc:implement": {
      "workflowStages": ["4", "6"],
      "persona": ["frontend", "backend"],
      "flags": ["--tdd", "--coverage"],
      "description": "代码实现和修正"
    },
    "/sc:analyze": {
      "workflowStages": ["0", "5"],
      "persona": "analyzer",
      "flags": ["--architecture", "--code", "--profile", "--perf", "--seq"],
      "description": "需求分析或代码分析"
    },
    "/sc:improve": {
      "workflowStages": ["5", "6"],
      "persona": ["refactorer", "performance", "critic"],
      "flags": ["--quality", "--performance", "--iterate", "--threshold"],
      "description": "代码改进和优化，V4中Critic角色使用"
    },
    "/sc:reflect": {
      "workflowStages": ["1", "5"],
      "persona": ["critic", "refactorer"],
      "flags": ["--evidence"],
      "description": "任务反思和验证，V4中Critic使用"
    },
    "/sc:test": {
      "workflowStages": ["7"],
      "persona": "qa",
      "flags": ["--unit", "--integration", "--e2e", "--coverage"],
      "description": "测试执行，用于阶段7"
    },
    "/sc:git": {
      "workflowStages": ["8"],
      "persona": "none",
      "flags": [],
      "description": "Git操作，用于阶段8"
    },
    "/sc:document": {
      "workflowStages": ["9"],
      "persona": "dynamic",
      "flags": [],
      "description": "文档生成，用于阶段9"
    },
    "/sc:troubleshoot": {
      "workflowStages": ["任意阶段"],
      "persona": "analyzer",
      "flags": ["--investigate", "--prod", "--five-whys", "--seq"],
      "description": "问题排查，可在任意阶段使用"
    }
  },

  "flagsDefinition": {
    "planning": {
      "-plan": "显示执行计划（在执行前预览）",
      "-think": "标准分析模式",
      "-think-hard": "深度分析模式"
    },
    "mcpServers": {
      "-c7": "启用Context7文档查找",
      "-seq": "启用Sequential深度思维",
      "-magic": "启用Magic UI构建器",
      "-pup": "启用Puppeteer浏览器测试"
    },
    "outputControl": {
      "-uc": "UltraCompressed模式（约70%令牌减少）",
      "-verbose": "详细输出模式"
    },
    "development": {
      "-init": "项目初始化",
      "-feature": "功能开发",
      "-tdd": "测试驱动开发",
      "-coverage": "代码覆盖率",
      "-e2e": "端到端测试"
    },
    "design": {
      "-api": "API设计",
      "-ddd": "领域驱动设计",
      "-prd": "产品需求文档",
      "-openapi": "OpenAPI规范"
    },
    "security": {
      "-security": "安全扫描",
      "-owasp": "OWASP检查"
    },
    "analysis": {
      "-architecture": "架构分析",
      "-code": "代码分析",
      "-profile": "性能分析",
      "-perf": "性能测试"
    },
    "quality": {
      "-quality": "质量检查",
      "-evidence": "证据收集",
      "-threshold": "质量阈值",
      "-iterate": "迭代改进"
    }
  },

  "V4_integrationStrategy": {
    "description": "V4.0 SuperClaude 与工作流集成策略 - 支持三方对抗",
    "核心规则": [
      "每个工作流阶段自动激活对应的 Persona 角色",
      "阶段1使用三方对抗机制：Designer → Critic → Architect",
      "前端使用Gemini，后端使用Codex",
      "所有Agent调用必须串行执行，禁止并行",
      "每个Agent完成后主控必须验证输出",
      "所有长任务Agent必须包含渐进式休眠指令"
    ],
    "V4示例": [
      {
        "stage": "P0",
        "persona": "architect (Opus)",
        "command": "/sc:design --architecture --plan",
        "V4增强": "完成后等待用户审查确认"
      },
      {
        "stage": "1.步骤1",
        "persona": "designer (Gemini)",
        "command": "/sc:design --api --ddd",
        "V4增强": "起草完整的前后端设计"
      },
      {
        "stage": "1.步骤2",
        "persona": "critic (Codex)",
        "command": "/sc:improve --quality --evidence OR /sc:reflect",
        "V4增强": "红队攻击，找出所有漏洞"
      },
      {
        "stage": "1.步骤4",
        "persona": "architect (Opus)",
        "command": "/sc:design --plan",
        "V4增强": "终审批准或驳回"
      },
      {
        "stage": "4_frontend",
        "persona": "frontend (Gemini)",
        "command": "/sc:build --react --magic --tdd",
        "V4增强": "包含渐进式休眠指令"
      },
      {
        "stage": "4_backend",
        "persona": "backend (Codex)",
        "command": "/sc:build --api --tdd",
        "V4增强": "包含渐进式休眠指令"
      },
      {
        "stage": "8",
        "persona": "none (Haiku)",
        "command": "/sc:git",
        "V4增强": "测试通过立即提交"
      }
    ]
  },

  "usageGuidelines": {
    "V4_autoActivation": "工作流自动激活对应阶段的 Persona，严格按照三方对抗流程执行",
    "V4_serialExecution": "所有Agent必须串行调用，一个完成验证后再调用下一个",
    "V4_mandatoryHandover": "每次调用Agent必须准备交接文档",
    "V4_progressiveSleep": "长任务Agent的交接文档必须包含渐进式休眠指令",
    "commandUsage": "在工作流提示中可使用斜杠命令简化描述",
    "flagCombination": "可组合多个标志实现复杂功能",
    "mcpIntegration": "标志 -c7, -seq, -magic, -pup 会调用对应的 MCP 服务器"
  }
}

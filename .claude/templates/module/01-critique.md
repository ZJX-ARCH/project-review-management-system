# 迭代对抗设计 - Critic红队攻击

> **V4.0阶段1步骤2** - Codex 5.1红队攻击找漏洞
> **迭代轮次**: 第{N}轮

---

## 模块信息

**模块名称**: [模块名]

**Critic**: Codex 5.1

**审查时间**: [YYYY-MM-DD HH:MM]

**迭代轮次**: 第{N}轮（最多5轮）

**被审查文档**: 01-design-v{N}.md

---

## ⚠️ Critic职责（V4迭代模式）

作为Critic（红队攻击者），你需要：
1. **全面检查**Designer的设计（这是第{N}轮审查）
2. **找出所有漏洞**：功能遗漏、安全漏洞、性能问题、边缘案例
3. **标记严重程度**：Critical / High / Medium / Low
4. **不要手软**：宁可多找问题，不可遗漏
5. **参考**：guides/ANTI_FORGET_CHECKLIST.md
6. **⚠️ V4新增**：在报告末尾明确说明Critical和High问题数量，决定是否需要继续修正

---

## ⚠️ V4迭代循环控制

本轮审查需要回答：
- **这是第几轮审查？** 第{N}轮（共最多5轮）
- **上一轮修正是否有效？** [如果N>1，评价Designer的修正质量]
- **是否还有Critical/High问题？** [是/否]
- **是否需要继续迭代？** [是/否/建议终审]

---

## Critical问题（必须修复）

### Critical-1: [问题标题]

**类型**: [功能遗漏/安全漏洞/数据丢失风险/...]

**描述**: [详细描述问题]

**影响**: [这个问题会导致什么严重后果]

**位置**: [在设计文档的哪个部分]

**建议**: [如何修复]

**示例**:
```
原设计：只有登录功能
问题：缺少"忘记密码"功能
影响：用户忘记密码后无法登录，导致用户流失
建议：添加"忘记密码"功能（邮箱重置）
```

---

## High问题（强烈建议修复）

### High-1: [问题标题]

[同上结构]

---

## Medium问题（建议修复）

### Medium-1: [问题标题]

[同上结构]

---

## Low问题（可选修复）

### Low-1: [问题标题]

[同上结构]

---

## 功能遗漏检查（使用ANTI_FORGET_CHECKLIST.md）

### CRUD完整性

- [ ] Create（创建）
- [ ] Read（读取）
- [ ] Update（更新）
- [ ] Delete（删除）
- [ ] Validation（验证）
- [ ] Error Handling（错误处理）

**发现的遗漏**: [列出]

---

### 前后端对应

[检查每个前端页面是否有对应的后端API]

**发现的遗漏**: [列出]

---

### 安全检查

- [ ] SQL注入防护
- [ ] XSS防护
- [ ] CSRF防护
- [ ] 密码加密
- [ ] API认证
- [ ] API授权
- [ ] 敏感数据加密
- [ ] API限流
- [ ] HTTPS强制
- [ ] 安全响应头

**发现的漏洞**: [列出]

---

### 性能检查

- [ ] 数据库索引
- [ ] N+1查询优化
- [ ] 分页加载
- [ ] 缓存策略
- [ ] 静态资源CDN
- [ ] 图片懒加载
- [ ] 代码分割
- [ ] API响应压缩

**发现的问题**: [列出]

---

### 边缘案例

- [ ] 空值处理（空字符串、null、undefined）
- [ ] 超长输入处理
- [ ] 并发处理
- [ ] 特殊字符处理

**发现的遗漏**: [列出]

---

### 用户体验

- [ ] Loading提示
- [ ] Error提示
- [ ] Success提示
- [ ] 确认对话框（删除等危险操作）
- [ ] 空状态提示
- [ ] 禁用状态
- [ ] 键盘导航
- [ ] 响应式设计

**发现的遗漏**: [列出]

---

## 过度设计检查（林纳斯三问）

### 1. 这是真实问题吗？

[检查是否有不必要的功能]

### 2. 有没有更简单的方法？

[检查是否过度设计]

### 3. 这会破坏什么？

[检查向后兼容性]

---

## V4迭代评估（第{N}轮）

### 上一轮修正评价（如N>1）

[评价Designer上一轮的修正质量]

- ✅ 已修复的问题：[列出]
- ⚠️ 修复不完整的问题：[列出]
- ❌ 未修复的问题：[列出]

---

## 总结

### 问题统计

- **Critical**: **{X}**个  ⚠️ 必须为0才能终审
- **High**: **{Y}**个      ⚠️ 必须为0才能终审
- **Medium**: {Z}个
- **Low**: {W}个

### ⚠️ V4迭代控制决策（重要）

**当前状态**：
- 迭代轮次：第{N}轮 / 最多5轮
- Critical问题：**{X}**个
- High问题：**{Y}**个

**Critic决策**：

[ ] ✅ **可以进入终审**
    - Critical问题 = 0 AND High问题 = 0
    - 设计质量达标，建议交给Architect终审

[ ] ⚠️ **需要继续迭代**
    - Critical问题 > 0 OR High问题 > 0
    - 需要Designer修正上述Critical和High问题
    - 修正后Critic将进行第{N+1}轮审查

[ ] 🚫 **达到最大迭代次数**
    - 已经是第5轮审查
    - 即使有Critical/High问题，也必须进入Architect终审
    - 由Architect决定是否批准或驳回

---

## 下一步

- **如果可以进入终审**：主控调用Architect（Opus）进行最终审查
- **如果需要继续迭代**：主控调用Designer（Gemini）进行第{N+1}轮修正
- **如果达到最大次数**：强制进入Architect终审

---

**🔴 此文档由Critic（Codex）在阶段1步骤2生成**
**🔄 迭代轮次：第{N}轮 / 最多5轮**

# é¡¹ç›®å·²å°è£…åŠŸèƒ½æ¸…å•

> æœ¬æ–‡æ¡£æ•´ç†äº† ContiNew Admin å’Œ ContiNew Starter ä¸­å·²å°è£…çš„å¯å¤ç”¨åŠŸèƒ½ï¼Œé¿å…é‡å¤å¼€å‘ã€‚

---

## ğŸ“± ä¸€ã€å‰ç«¯å·²å°è£…åŠŸèƒ½ (continew-admin-ui)

### 1.1 Hooks (Composables)

#### ğŸ¯ ä¸šåŠ¡ Hooks (`src/hooks/app/`)

| Hookåç§° | æ–‡ä»¶è·¯å¾„ | åŠŸèƒ½è¯´æ˜ | ä½¿ç”¨ç¤ºä¾‹ |
|---------|---------|---------|---------|
| **useDict** | `src/hooks/app/useDict.ts` | **å­—å…¸æŸ¥è¯¢** - è‡ªåŠ¨ç¼“å­˜ï¼Œå»é‡è¯·æ±‚ | `const { eval_template_score } = useDict('eval_template_score')` |
| useDept | `src/hooks/app/useDept.ts` | éƒ¨é—¨æ•°æ®æŸ¥è¯¢ | - |
| useMenu | `src/hooks/app/useMenu.ts` | èœå•æ•°æ®ç®¡ç† | - |
| useRole | `src/hooks/app/useRole.ts` | è§’è‰²æ•°æ®ç®¡ç† | - |

**useDict è¯¦ç»†è¯´æ˜ï¼š**
```typescript
// è‡ªåŠ¨ä»åç«¯è·å–å­—å…¸æ•°æ®ï¼Œæ”¯æŒç¼“å­˜å’Œå»é‡è¯·æ±‚
const { eval_template_score, status_dict } = useDict('eval_template_score', 'status_dict')

// è¿”å›å€¼æ˜¯å“åº”å¼çš„ Ref<App.DictItem[]>
// DictItem ç»“æ„ï¼š{ label: string, value: any, ...}
```

#### ğŸ› ï¸ é€šç”¨ Hooks (`src/hooks/modules/`)

| Hookåç§° | æ–‡ä»¶è·¯å¾„ | åŠŸèƒ½è¯´æ˜ | ä½¿ç”¨ç¤ºä¾‹ |
|---------|---------|---------|---------|
| **useTable** | `src/hooks/modules/useTable.ts` | **è¡¨æ ¼æ•°æ®ç®¡ç†** - åˆ†é¡µã€å¤šé€‰ã€åˆ é™¤ã€åˆ·æ–° | è§ä¸‹æ–¹è¯¦ç»†ç¤ºä¾‹ |
| **useDownload** | `src/hooks/modules/useDownload.ts` | **æ–‡ä»¶ä¸‹è½½** - Blobæµå¤„ç†ï¼Œæ–‡ä»¶åè‡ªåŠ¨æå– | `await useDownload(exportApi, 'æ–‡ä»¶å.xlsx')` |
| usePagination | `src/hooks/modules/usePagination.ts` | åˆ†é¡µé€»è¾‘å°è£… | é€šå¸¸ç”± useTable å†…éƒ¨ä½¿ç”¨ |
| useRequest | `src/hooks/modules/useRequest.ts` | è¯·æ±‚çŠ¶æ€ç®¡ç†ï¼ˆloading/errorï¼‰ | - |
| useLoading | `src/hooks/modules/useLoading.ts` | Loading çŠ¶æ€ç®¡ç† | - |
| useBreakpoint | `src/hooks/modules/useBreakpoint.ts` | å“åº”å¼æ–­ç‚¹æ£€æµ‹ï¼ˆxs/sm/md/lg/xlï¼‰ | - |
| useDevice | `src/hooks/modules/useDevice.ts` | è®¾å¤‡ç±»å‹æ£€æµ‹ï¼ˆmobile/desktopï¼‰ | - |
| useMultipartUploader | `src/hooks/modules/useMultipartUploader.ts` | åˆ†ç‰‡ä¸Šä¼ åŠŸèƒ½ | - |
| useResetReactive | `src/hooks/modules/useResetReactive.ts` | é‡ç½®å“åº”å¼å¯¹è±¡ | - |
| useChart | `src/hooks/modules/useChart.ts` | ECharts å›¾è¡¨å°è£… | - |
| useRouteListener | `src/hooks/modules/useRouteListener.ts` | è·¯ç”±ç›‘å¬ | - |
| useComponentPaths | `src/hooks/modules/useComponentPaths.ts` | ç»„ä»¶è·¯å¾„è¾…åŠ© | - |

**useTable è¯¦ç»†è¯´æ˜ï¼š**
```typescript
const {
  loading,           // è¡¨æ ¼åŠ è½½çŠ¶æ€
  tableData,         // è¡¨æ ¼æ•°æ®
  pagination,        // åˆ†é¡µé…ç½®
  selectedKeys,      // é€‰ä¸­çš„è¡Œkeys
  select,            // é€‰æ‹©è¡Œäº‹ä»¶
  selectAll,         // å…¨é€‰äº‹ä»¶
  search,            // æœç´¢ï¼ˆé‡ç½®åˆ°ç¬¬1é¡µï¼‰
  refresh,           // åˆ·æ–°ï¼ˆä¿æŒå½“å‰é¡µï¼‰
  getTableData,      // æ‰‹åŠ¨è·å–æ•°æ®
  handleDelete,      // åˆ é™¤å¤„ç†ï¼ˆå¸¦ç¡®è®¤å¼¹çª—ï¼‰
  fixed              // æ“ä½œåˆ—å›ºå®šé…ç½®ï¼ˆå“åº”å¼ï¼‰
} = useTable(listApi, {
  formatResult: (data) => data,
  onSuccess: () => console.log('åŠ è½½æˆåŠŸ'),
  immediate: true,  // æ˜¯å¦ç«‹å³åŠ è½½
  rowKey: 'id'
})

// åˆ é™¤ç¤ºä¾‹
await handleDelete(() => deleteApi(id), {
  title: 'ç¡®è®¤åˆ é™¤',
  content: 'æ˜¯å¦åˆ é™¤è¯¥è®°å½•ï¼Ÿ',
  successTip: 'åˆ é™¤æˆåŠŸ',
  multiple: false  // æ˜¯å¦æ‰¹é‡åˆ é™¤
})
```

**useDownload è¯¦ç»†è¯´æ˜ï¼š**
```typescript
// åŸºæœ¬ç”¨æ³•
await useDownload(
  () => exportTemplateApi(params),  // è¿”å› Blob çš„ API
  'è¯„ä¼°æ¨¡æ¿.xlsx',                  // æ–‡ä»¶åï¼ˆå¯é€‰ï¼‰
  '.xlsx',                          // æ–‡ä»¶ç±»å‹ï¼ˆé»˜è®¤ .xlsxï¼‰
  true                              // æ˜¯å¦æ˜¾ç¤ºä¸‹è½½æç¤ºï¼ˆé»˜è®¤ falseï¼‰
)

// è‡ªåŠ¨ä»å“åº”å¤´æå–æ–‡ä»¶å
await useDownload(() => exportApi())
```

---

### 1.2 ç»„ä»¶ (Components)

#### ğŸ“Š è¡¨æ ¼è¡¨å•ç»„ä»¶

| ç»„ä»¶åç§° | æ–‡ä»¶è·¯å¾„ | åŠŸèƒ½è¯´æ˜ | ä¸»è¦Props |
|---------|---------|---------|----------|
| **GiTable** | `src/components/GiTable/` | **é«˜çº§è¡¨æ ¼** - åˆ—è®¾ç½®ã€åˆ†é¡µã€æ’åº | `columns`, `data`, `pagination`, `row-selection` |
| **GiForm** | `src/components/GiForm/` | **åŠ¨æ€è¡¨å•** - é…ç½®åŒ–è¡¨å•ç”Ÿæˆ | `schema`, `model`, `rules` |
| **GiPageLayout** | `src/components/GiPageLayout/` | **é¡µé¢å¸ƒå±€** - ç»Ÿä¸€çš„é¡µé¢å®¹å™¨ | `title`, `breadcrumb` |
| GiEditTable | `src/components/GiEditTable/` | **å¯ç¼–è¾‘è¡¨æ ¼** - è¡Œå†…ç¼–è¾‘ | - |

#### ğŸ¨ UIç»„ä»¶

| ç»„ä»¶åç§° | æ–‡ä»¶è·¯å¾„ | åŠŸèƒ½è¯´æ˜ |
|---------|---------|---------|
| GiCellç³»åˆ— | `src/components/GiCell/` | å•å…ƒæ ¼æ¸²æŸ“ç»„ä»¶ï¼ˆStatusã€Tag ç­‰ï¼‰ |
| GiIconSelector | `src/components/GiIconSelector/` | å›¾æ ‡é€‰æ‹©å™¨ |
| GiSplitPane | `src/components/GiSplitPane/` | åˆ†å‰²é¢æ¿ |
| DateRangePicker | `src/components/DateRangePicker/` | æ—¥æœŸèŒƒå›´é€‰æ‹©å™¨ |
| TextCopy | `src/components/TextCopy/` | æ–‡æœ¬å¤åˆ¶ç»„ä»¶ |
| MultipartUpload | `src/components/MultipartUpload/` | åˆ†ç‰‡ä¸Šä¼ ç»„ä»¶ |

---

### 1.3 å·¥å…·å‡½æ•° (Utils)

| å·¥å…·åç§° | æ–‡ä»¶è·¯å¾„ | åŠŸèƒ½è¯´æ˜ |
|---------|---------|---------|
| **http** | `src/utils/http.ts` | Axios å°è£…ï¼Œè¯·æ±‚/å“åº”æ‹¦æˆªå™¨ |
| **downloadFile** | `src/utils/downloadFile.ts` | æ–‡ä»¶ä¸‹è½½å·¥å…· |
| auth | `src/utils/auth.ts` | Token å­˜å‚¨/è·å–/æ¸…é™¤ |
| validate | `src/utils/validate.ts` | è¡¨å•éªŒè¯è§„åˆ™ |
| has | `src/utils/has.ts` | æƒé™åˆ¤æ–­å·¥å…· |
| encrypt | `src/utils/encrypt.ts` | åŠ å¯†/è§£å¯†å·¥å…· |
| regexp | `src/utils/regexp.ts` | å¸¸ç”¨æ­£åˆ™è¡¨è¾¾å¼ |

---

### 1.4 çŠ¶æ€ç®¡ç† (Stores)

| Storeåç§° | æ–‡ä»¶è·¯å¾„ | åŠŸèƒ½è¯´æ˜ |
|----------|---------|---------|
| **dictStore** | `src/stores/modules/dict.ts` | **å­—å…¸æ•°æ®ç¼“å­˜** - é…åˆ useDict ä½¿ç”¨ |
| userStore | `src/stores/modules/user.ts` | ç”¨æˆ·ä¿¡æ¯çŠ¶æ€ |
| routeStore | `src/stores/modules/route.ts` | è·¯ç”±çŠ¶æ€ç®¡ç† |

---

## âš™ï¸ äºŒã€åç«¯å·²å°è£…åŠŸèƒ½ (continew-admin)

### 2.1 Baseç±» (CRUDåŸºç¡€)

| ç±»å | æ–‡ä»¶è·¯å¾„ | åŠŸèƒ½è¯´æ˜ | ä½¿ç”¨åœºæ™¯ |
|-----|---------|---------|---------|
| **BaseController** | `continew-common/src/main/java/.../base/controller/BaseController.java` | **ControlleråŸºç±»** - è‡ªåŠ¨CRUDæ¥å£ | ç»§æ‰¿åè‡ªåŠ¨è·å¾—å¢åˆ æ”¹æŸ¥API |
| **BaseService** | `continew-common/src/main/java/.../base/service/BaseService.java` | Serviceæ¥å£åŸºç±» | å®šä¹‰ä¸šåŠ¡æ¥å£ |
| **BaseServiceImpl** | `continew-common/src/main/java/.../base/service/BaseServiceImpl.java` | **Serviceå®ç°åŸºç±»** - è‡ªåŠ¨CRUDé€»è¾‘ | ç»§æ‰¿åè‡ªåŠ¨å®ç°å¢åˆ æ”¹æŸ¥ |
| BaseMapper | `continew-starter/.../BaseMapper.java` | MapperåŸºç±»ï¼ˆMyBatis-Plusï¼‰ | æ•°æ®è®¿é—®å±‚ |

**BaseController ä½¿ç”¨ç¤ºä¾‹ï¼š**
```java
@Tag(name = "è¯„ä¼°æ¨¡æ¿ç®¡ç†")
@RestController
@RequestMapping("/api/prj/evaluation_template")
public class EvaluationTemplateController extends BaseController<
    EvaluationTemplateService,
    EvaluationTemplateResp,
    EvaluationTemplateDetailResp,
    EvaluationTemplateQuery,
    EvaluationTemplateReq
> {
    // è‡ªåŠ¨è·å¾—ä»¥ä¸‹APIï¼š
    // - POST   /api/prj/evaluation_template        åˆ›å»º
    // - PUT    /api/prj/evaluation_template/{id}   æ›´æ–°
    // - DELETE /api/prj/evaluation_template        åˆ é™¤
    // - GET    /api/prj/evaluation_template/{id}   è¯¦æƒ…
    // - GET    /api/prj/evaluation_template/page   åˆ†é¡µåˆ—è¡¨
    // - GET    /api/prj/evaluation_template/list   å…¨éƒ¨åˆ—è¡¨
    // - GET    /api/prj/evaluation_template/dict   å­—å…¸æ•°æ®
}
```

**é‡å†™ CRUD æ–¹æ³•ï¼ˆè‡ªå®šä¹‰é€»è¾‘ï¼‰ï¼š**
```java
// å½“è‡ªåŠ¨ç”Ÿæˆçš„ CRUD ä¸æ»¡è¶³éœ€æ±‚æ—¶ï¼Œå¯ä»¥é‡å†™ï¼š
@Override
public void create(EvaluationTemplateReq req) {
    // è‡ªå®šä¹‰åˆ›å»ºé€»è¾‘ï¼ˆå¤šè¡¨äº‹åŠ¡ç­‰ï¼‰
}
```

---

### 2.2 å®ä½“åŸºç±» (Entity Base)

| ç±»å | æ–‡ä»¶è·¯å¾„ | åŠŸèƒ½è¯´æ˜ | å­—æ®µ |
|-----|---------|---------|------|
| BaseDO | `continew-common/.../base/model/entity/BaseDO.java` | **åŸºç¡€å®ä½“**ï¼ˆæ¨èä½¿ç”¨ï¼‰ | `id`, `createUser`, `createTime`, `updateUser`, `updateTime`, `deleted` |
| BaseCreateDO | `continew-common/.../base/model/entity/BaseCreateDO.java` | åˆ›å»ºä¿¡æ¯ | `id`, `createUser`, `createTime` |
| BaseUpdateDO | `continew-common/.../base/model/entity/BaseUpdateDO.java` | æ›´æ–°ä¿¡æ¯ | `id`, `updateUser`, `updateTime` |

**BaseDO è‡ªåŠ¨å¡«å……è¯´æ˜ï¼š**
```java
// ç»§æ‰¿ BaseDO åï¼Œä»¥ä¸‹å­—æ®µä¼šè‡ªåŠ¨å¡«å……ï¼Œæ— éœ€æ‰‹åŠ¨è®¾ç½®
@Data
@TableName("your_table")
public class YourEntityDO extends BaseDO {
    private String name;
    // createUser, createTime, updateUser, updateTime è‡ªåŠ¨å¡«å……
}

// æ’å…¥æ—¶è‡ªåŠ¨å¡«å……ï¼šcreateUserï¼ˆå½“å‰ç”¨æˆ·IDï¼‰ã€createTimeï¼ˆå½“å‰æ—¶é—´ï¼‰
// æ›´æ–°æ—¶è‡ªåŠ¨å¡«å……ï¼šupdateUserï¼ˆå½“å‰ç”¨æˆ·IDï¼‰ã€updateTimeï¼ˆå½“å‰æ—¶é—´ï¼‰
```

---

### 2.3 æ ¸å¿ƒå·¥å…·ç±»

| å·¥å…·ç±» | æ–‡ä»¶è·¯å¾„ | åŠŸèƒ½è¯´æ˜ | ä½¿ç”¨ç¤ºä¾‹ |
|-------|---------|---------|---------|
| **UserContextHolder** | `continew-common/.../context/UserContextHolder.java` | **è·å–å½“å‰ç™»å½•ç”¨æˆ·ä¿¡æ¯** | `Long userId = UserContextHolder.getUserId()` |
| **SecureUtils** | `continew-common/.../util/SecureUtils.java` | **RSAåŠ å¯†è§£å¯†**ï¼ˆç”¨äºå¯†ç ä¼ è¾“ï¼‰ | `SecureUtils.decryptByRsaPrivateKey(cipherText)` |
| RedisUtils | continew-starter-cache | Redisæ“ä½œå·¥å…· | `RedisUtils.deleteByPattern(pattern)` |
| CheckUtils | continew-starter-core | å‚æ•°æ ¡éªŒå·¥å…· | `CheckUtils.throwIf(condition, "é”™è¯¯æ¶ˆæ¯")` |

**UserContextHolder è¯¦ç»†è¯´æ˜ï¼š**
```java
// è·å–å½“å‰ç™»å½•ç”¨æˆ·ä¿¡æ¯ï¼ˆåœ¨Serviceæˆ–ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥è°ƒç”¨ï¼‰
Long userId = UserContextHolder.getUserId();           // ç”¨æˆ·ID
String username = UserContextHolder.getUsername();     // ç”¨æˆ·å
String nickname = UserContextHolder.getNickname();     // æ˜µç§°
Long tenantId = UserContextHolder.getTenantId();       // ç§Ÿæˆ·ID
boolean isAdmin = UserContextHolder.isSuperAdmin();    // æ˜¯å¦è¶…çº§ç®¡ç†å‘˜

// ä½¿ç”¨åœºæ™¯ï¼šåˆ›å»ºæ•°æ®æ—¶è®°å½•åˆ›å»ºäºº
TemplateDO template = new TemplateDO();
template.setName(req.getName());
template.setCreateUser(UserContextHolder.getUserId());  // æ‰‹åŠ¨è®¾ç½®ï¼ˆç»§æ‰¿BaseDOæ—¶ä¼šè‡ªåŠ¨å¡«å……ï¼‰
```

**SecureUtils è¯¦ç»†è¯´æ˜ï¼š**
```java
// RSA åŠ å¯†ï¼ˆå‰ç«¯ç”¨å…¬é’¥åŠ å¯†æ•æ„Ÿæ•°æ®ä¼ è¾“ï¼‰
String encrypted = SecureUtils.encryptByRsaPublicKey(plainText);

// RSA è§£å¯†ï¼ˆåç«¯ç”¨ç§é’¥è§£å¯†ï¼‰
String decrypted = SecureUtils.decryptByRsaPrivateKey(cipherText);

// è§£å¯†å¹¶éªŒè¯å¯†ç æ ¼å¼
String password = SecureUtils.decryptPasswordByRsaPrivateKey(
    encryptedPassword,
    "å¯†ç è§£å¯†å¤±è´¥",
    true  // æ˜¯å¦éªŒè¯å¯†ç æ ¼å¼
);
```

---

### 2.4 å¼‚å¸¸å¤„ç†

| åŠŸèƒ½ | æ–‡ä»¶è·¯å¾„ | å¤„ç†å¼‚å¸¸ç±»å‹ |
|-----|---------|------------|
| **GlobalExceptionHandler** | `continew-common/.../config/exception/GlobalExceptionHandler.java` | ä¸šåŠ¡å¼‚å¸¸ã€å‚æ•°æ ¡éªŒã€è¯·æ±‚é”™è¯¯ç­‰ |
| **GlobalSaTokenExceptionHandler** | `continew-common/.../config/exception/GlobalSaTokenExceptionHandler.java` | æƒé™ä¸è¶³ã€ç™»å½•è¿‡æœŸç­‰ |

**è‡ªåŠ¨å¤„ç†çš„å¼‚å¸¸ï¼š**
- `BusinessException` - ä¸šåŠ¡å¼‚å¸¸ï¼ˆè¿”å›ä¸šåŠ¡é”™è¯¯æ¶ˆæ¯ï¼‰
- `BindException` - å‚æ•°æ ¡éªŒå¤±è´¥ï¼ˆè¿”å›æ ¡éªŒé”™è¯¯ï¼‰
- `NotLoginException` - æœªç™»å½•/ç™»å½•è¿‡æœŸ
- `NotPermissionException` - æƒé™ä¸è¶³
- `MultipartException` - æ–‡ä»¶ä¸Šä¼ å¼‚å¸¸
- å…¶ä»–ç³»ç»Ÿå¼‚å¸¸

æ‰€æœ‰å¼‚å¸¸éƒ½è¿”å›ç»Ÿä¸€çš„ JSON æ ¼å¼ï¼š
```json
{
  "success": false,
  "code": "é”™è¯¯ç ",
  "msg": "é”™è¯¯æ¶ˆæ¯",
  "data": null
}
```

---

### 2.5 æ•°æ®æƒé™

| åŠŸèƒ½ | æ–‡ä»¶è·¯å¾„ | è¯´æ˜ |
|-----|---------|-----|
| **DataPermissionMapper** | `continew-common/.../base/mapper/DataPermissionMapper.java` | **æ•°æ®æƒé™è¿‡æ»¤Mapper** |
| DataScopeEnum | `continew-common/.../enums/DataScopeEnum.java` | æ•°æ®æƒé™èŒƒå›´æšä¸¾ |

**æ•°æ®æƒé™çº§åˆ«ï¼š**
```java
public enum DataScopeEnum {
    ALL(1, "å…¨éƒ¨æ•°æ®æƒé™"),              // æŸ¥çœ‹æ‰€æœ‰æ•°æ®
    DEPT_AND_CHILD(2, "æœ¬éƒ¨é—¨åŠä»¥ä¸‹æ•°æ®æƒé™"),  // æœ¬éƒ¨é—¨+å­éƒ¨é—¨
    DEPT(3, "æœ¬éƒ¨é—¨æ•°æ®æƒé™"),           // ä»…æœ¬éƒ¨é—¨
    SELF(4, "ä»…æœ¬äººæ•°æ®æƒé™"),           // ä»…è‡ªå·±åˆ›å»ºçš„æ•°æ®
    CUSTOM(5, "è‡ªå®šä¹‰æ•°æ®æƒé™")          // è‡ªå®šä¹‰é€‰æ‹©éƒ¨é—¨
}
```

**ä½¿ç”¨æ–¹æ³•ï¼š**
```java
// Mapper ç»§æ‰¿ DataPermissionMapper
public interface TemplateMapper extends DataPermissionMapper<TemplateDO> {
}

// æŸ¥è¯¢æ—¶è‡ªåŠ¨åº”ç”¨æ•°æ®æƒé™è¿‡æ»¤
// ç”¨æˆ·åªèƒ½çœ‹åˆ°è‡ªå·±æƒé™èŒƒå›´å†…çš„æ•°æ®
List<TemplateDO> list = templateMapper.selectList(null);
```

---

### 2.6 ç¼“å­˜å¸¸é‡

| å¸¸é‡ç±» | æ–‡ä»¶è·¯å¾„ | è¯´æ˜ |
|-------|---------|-----|
| **CacheConstants** | `continew-common/.../constant/CacheConstants.java` | ç¼“å­˜Keyå‰ç¼€å®šä¹‰ |

**å¸¸ç”¨ç¼“å­˜Keyï¼š**
```java
CacheConstants.CAPTCHA_KEY_PREFIX        // éªŒè¯ç ç¼“å­˜
CacheConstants.USER_KEY_PREFIX           // ç”¨æˆ·ä¿¡æ¯ç¼“å­˜
CacheConstants.DICT_KEY_PREFIX           // å­—å…¸æ•°æ®ç¼“å­˜
CacheConstants.ROLE_MENU_KEY_PREFIX      // è§’è‰²èœå•ç¼“å­˜
CacheConstants.OPTION_KEY_PREFIX         // ç³»ç»Ÿå‚æ•°ç¼“å­˜
```

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```java
// æ¸…é™¤å­—å…¸ç¼“å­˜
RedisUtils.deleteByPattern(CacheConstants.DICT_KEY_PREFIX + dictCode);

// æ¸…é™¤ç”¨æˆ·ç¼“å­˜
RedisUtils.delete(CacheConstants.USER_KEY_PREFIX + userId);
```

---

### 2.7 å¸¸ç”¨æšä¸¾

| æšä¸¾ç±» | æ–‡ä»¶è·¯å¾„ | æšä¸¾å€¼ |
|-------|---------|-------|
| **DisEnableStatusEnum** | `continew-common/.../enums/DisEnableStatusEnum.java` | å¯ç”¨(1)/ç¦ç”¨(2) |
| DataScopeEnum | `continew-common/.../enums/DataScopeEnum.java` | æ•°æ®æƒé™èŒƒå›´ |
| GenderEnum | `continew-common/.../enums/GenderEnum.java` | ç”·(1)/å¥³(2)/æœªçŸ¥(3) |
| SuccessFailureStatusEnum | `continew-common/.../enums/SuccessFailureStatusEnum.java` | æˆåŠŸ(1)/å¤±è´¥(2) |

**DisEnableStatusEnum ä½¿ç”¨ç¤ºä¾‹ï¼š**
```java
// åœ¨å®ä½“ä¸­ä½¿ç”¨
@Data
public class TemplateDO extends BaseDO {
    private String name;
    private Integer status;  // 1-å¯ç”¨, 2-ç¦ç”¨
}

// åœ¨å‰ç«¯æ˜¾ç¤ºæ—¶ï¼Œä½¿ç”¨å­—å…¸æˆ–æšä¸¾æ˜ å°„
if (status == DisEnableStatusEnum.ENABLE.getValue()) {
    // å¯ç”¨çŠ¶æ€
}
```

---

### 2.8 æ³¨è§£ (Annotations)

| æ³¨è§£åç§° | æ¥æº | åŠŸèƒ½è¯´æ˜ | ä½¿ç”¨ç¤ºä¾‹ |
|---------|-----|---------|---------|
| **@CrudApi** | continew-starter-extension | **CRUD APIé…ç½®** - æ§åˆ¶å“ªäº›CRUDæ¥å£ç”Ÿæ•ˆ | `@CrudApi(value = {Api.PAGE, Api.GET, Api.CREATE, ...})` |
| @SaCheckPermission | Sa-Token | æƒé™æ ¡éªŒ | `@SaCheckPermission("system:user:create")` |
| @Operation | Knife4j (Swagger) | APIæ–‡æ¡£æ³¨é‡Š | `@Operation(summary = "åˆ›å»ºç”¨æˆ·")` |
| @DataPermission | continew-admin | æ•°æ®æƒé™æ§åˆ¶ | - |

**@CrudApi è¯¦ç»†è¯´æ˜ï¼š**
```java
// æ–¹å¼1ï¼šä½¿ç”¨æ‰€æœ‰CRUDæ¥å£ï¼ˆé»˜è®¤ï¼‰
@CrudApi

// æ–¹å¼2ï¼šæ’é™¤æŸäº›æ¥å£
@CrudApi(exclude = {Api.CREATE, Api.UPDATE})  // æ’é™¤åˆ›å»ºå’Œæ›´æ–°æ¥å£

// æ–¹å¼3ï¼šåªå¯ç”¨éƒ¨åˆ†æ¥å£
@CrudApi(value = {Api.PAGE, Api.GET})  // åªå¯ç”¨åˆ†é¡µå’Œè¯¦æƒ…æ¥å£

// å¯ç”¨çš„ Api æšä¸¾å€¼ï¼š
// - Api.CREATE       åˆ›å»º
// - Api.UPDATE       æ›´æ–°
// - Api.DELETE       åˆ é™¤
// - Api.BATCH_DELETE æ‰¹é‡åˆ é™¤
// - Api.GET          è¯¦æƒ…
// - Api.PAGE         åˆ†é¡µåˆ—è¡¨
// - Api.LIST         å…¨éƒ¨åˆ—è¡¨
// - Api.TREE         æ ‘å½¢åˆ—è¡¨
// - Api.DICT         å­—å…¸æ•°æ®
// - Api.TREE_DICT    æ ‘å½¢å­—å…¸
```

---

### 2.4 å­—å…¸ç³»ç»Ÿ

#### åç«¯å­—å…¸é…ç½®ï¼ˆLiquibaseï¼‰

**ä½ç½®ï¼š** `continew-server/src/main/resources/db/changelog/`

**ç¤ºä¾‹ï¼šåˆ›å»ºå­—å…¸æ•°æ®**
```xml
<!-- 001_dict_evaluation_template_score.xml -->
<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog>
    <changeSet id="001-dict-eval-template-score" author="your-name">
        <!-- 1. åˆ›å»ºå­—å…¸ç±»å‹ -->
        <insert tableName="sys_dict">
            <column name="name" value="è¯„ä¼°æ¨¡æ¿æ€»åˆ†"/>
            <column name="code" value="eval_template_score"/>
            <column name="description" value="è¯„ä¼°æ¨¡æ¿æ€»åˆ†å¯é€‰å€¼"/>
            <column name="status" value="1"/>
            <column name="sort" value="100"/>
        </insert>

        <!-- 2. åˆ›å»ºå­—å…¸é¡¹ -->
        <insert tableName="sys_dict_item">
            <column name="dict_id" valueComputed="(SELECT id FROM sys_dict WHERE code='eval_template_score')"/>
            <column name="label" value="100åˆ†"/>
            <column name="value" value="100"/>
            <column name="sort" value="1"/>
        </insert>
        <insert tableName="sys_dict_item">
            <column name="dict_id" valueComputed="(SELECT id FROM sys_dict WHERE code='eval_template_score')"/>
            <column name="label" value="120åˆ†"/>
            <column name="value" value="120"/>
            <column name="sort" value="2"/>
        </insert>
        <insert tableName="sys_dict_item">
            <column name="dict_id" valueComputed="(SELECT id FROM sys_dict WHERE code='eval_template_score')"/>
            <column name="label" value="150åˆ†"/>
            <column name="value" value="150"/>
            <column name="sort" value="3"/>
        </insert>
    </changeSet>
</databaseChangeLog>
```

#### å‰åç«¯å­—å…¸è”åŠ¨

**åç«¯ï¼š** è‡ªåŠ¨æä¾›å­—å…¸API
```java
// BaseController è‡ªåŠ¨æä¾›å­—å…¸æ¥å£
// GET /api/prj/evaluation_template/dict?code=eval_template_score
```

**å‰ç«¯ï¼š** useDict è‡ªåŠ¨è°ƒç”¨
```typescript
// è‡ªåŠ¨è°ƒç”¨ GET /api/system/common/dict?codes=eval_template_score
const { eval_template_score } = useDict('eval_template_score')

// åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨
<a-select v-model="form.totalScore">
  <a-option
    v-for="item in eval_template_score"
    :key="item.value"
    :value="item.value"
  >
    {{ item.label }}
  </a-option>
</a-select>
```

---

## ğŸ“¦ ä¸‰ã€Starterå·²å°è£…åŠŸèƒ½ (continew-starter)

### 3.1 Starteræ¨¡å—åˆ—è¡¨

**é¡¹ç›®Parentï¼š** `top.continew.starter:continew-starter:2.14.0`

| Starteræ¨¡å— | Mavenåæ ‡ | åŠŸèƒ½è¯´æ˜ |
|------------|-----------|---------|
| **continew-starter-core** | `top.continew.starter:continew-starter-core` | æ ¸å¿ƒå·¥å…·ç±»ã€å¼‚å¸¸å¤„ç† |
| **continew-starter-web** | `top.continew.starter:continew-starter-web` | Webé…ç½®ã€å…¨å±€å¼‚å¸¸ã€CORS |
| **continew-starter-data-mp** | `top.continew.starter:continew-starter-data-mp` | MyBatis-Plusé›†æˆ |
| **continew-starter-auth-satoken** | `top.continew.starter:continew-starter-auth-satoken` | Sa-Tokenæƒé™è®¤è¯ |
| **continew-starter-excel-alibaba** | `top.continew.starter:continew-starter-excel-alibaba` | **Excelå¯¼å…¥å¯¼å‡ºï¼ˆEasyExcelï¼‰** |
| **continew-starter-api-doc-knife4j** | `top.continew.starter:continew-starter-api-doc-knife4j` | Knife4j APIæ–‡æ¡£ |
| **continew-starter-cache-redisson** | `top.continew.starter:continew-starter-cache-redisson` | Redissonç¼“å­˜ |
| **continew-starter-log-webcal** | `top.continew.starter:continew-starter-log-webcal` | æ“ä½œæ—¥å¿— |
| **continew-starter-storage-local** | `top.continew.starter:continew-starter-storage-local` | æœ¬åœ°æ–‡ä»¶å­˜å‚¨ |
| **continew-starter-trace** | `top.continew.starter:continew-starter-trace` | é“¾è·¯è¿½è¸ª |
| **continew-starter-validation** | `top.continew.starter:continew-starter-validation` | å‚æ•°éªŒè¯å¢å¼º |
| **continew-starter-json-jackson** | `top.continew.starter:continew-starter-json-jackson` | JSONåºåˆ—åŒ– |
| continew-starter-captcha | `top.continew.starter:continew-starter-captcha` | éªŒè¯ç  |
| continew-starter-messaging | `top.continew.starter:continew-starter-messaging` | æ¶ˆæ¯æ¨é€ |
| continew-starter-encrypt | `top.continew.starter:continew-starter-encrypt` | å­—æ®µåŠ å¯† |
| continew-starter-security | `top.continew.starter:continew-starter-security` | å®‰å…¨é˜²æŠ¤ï¼ˆXSSã€SQLæ³¨å…¥ï¼‰ |
| continew-starter-ratelimiter | `top.continew.starter:continew-starter-ratelimiter` | é™æµ |
| continew-starter-idempotent | `top.continew.starter:continew-starter-idempotent` | å¹‚ç­‰æ€§ |
| continew-starter-license | `top.continew.starter:continew-starter-license` | è®¸å¯è¯ç®¡ç† |
| continew-starter-extension | `top.continew.starter:continew-starter-extension` | **æ‰©å±•åŠŸèƒ½ï¼ˆCRUDè‡ªåŠ¨åŒ–ï¼‰** |

---

### 3.2 Starterå¼•å…¥æ–¹å¼

#### æ–¹å¼1ï¼šé€šè¿‡parentç»§æ‰¿ï¼ˆæ¨èï¼‰

```xml
<!-- continew-admin/pom.xml -->
<parent>
    <groupId>top.continew.starter</groupId>
    <artifactId>continew-starter</artifactId>
    <version>2.14.0</version>
</parent>

<!-- å­æ¨¡å—ç›´æ¥å¼•å…¥ï¼ˆæ— éœ€æŒ‡å®šversionï¼‰ -->
<dependency>
    <groupId>top.continew.starter</groupId>
    <artifactId>continew-starter-excel-alibaba</artifactId>
</dependency>
```

#### æ–¹å¼2ï¼šé€šè¿‡dependencyManagementç®¡ç†

```xml
<dependencyManagement>
    <dependencies>
        <dependency>
            <groupId>top.continew.starter</groupId>
            <artifactId>continew-starter-bom</artifactId>
            <version>2.14.0</version>
            <type>pom</type>
            <scope>import</scope>
        </dependency>
    </dependencies>
</dependencyManagement>

<dependencies>
    <dependency>
        <groupId>top.continew.starter</groupId>
        <artifactId>continew-starter-excel-alibaba</artifactId>
    </dependency>
</dependencies>
```

---

### 3.3 é‡ç‚¹Starterè¯¦ç»†è¯´æ˜

#### 3.3.1 continew-starter-excel-alibabaï¼ˆExcelå¯¼å…¥å¯¼å‡ºï¼‰

**åŠŸèƒ½ï¼š** åŸºäº EasyExcel å°è£…ï¼Œç®€åŒ–Excelæ“ä½œ

**å¼•å…¥ï¼š**
```xml
<dependency>
    <groupId>top.continew.starter</groupId>
    <artifactId>continew-starter-excel-alibaba</artifactId>
</dependency>
```

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```java
// å¯¼å‡º
@GetMapping("/export")
public void export(HttpServletResponse response) {
    List<TemplateExportResp> data = service.listForExport();
    ExcelUtils.export(data, "æ¨¡æ¿åˆ—è¡¨", TemplateExportResp.class, response);
}

// è‡ªå®šä¹‰æ ·å¼å¯¼å‡º
ExcelUtils.export(
    data,
    "æ¨¡æ¿åˆ—è¡¨",
    TemplateExportResp.class,
    response,
    new CustomCellWriteHandler()  // è‡ªå®šä¹‰æ ·å¼å¤„ç†å™¨
);

// å¯¼å…¥
@PostMapping("/import")
public void importData(MultipartFile file) {
    List<TemplateImportReq> data = ExcelUtils.read(file, TemplateImportReq.class);
    service.batchImport(data);
}
```

#### 3.3.2 continew-starter-extensionï¼ˆCRUDè‡ªåŠ¨åŒ–ï¼‰

**åŠŸèƒ½ï¼š** æä¾› `@CrudApi` æ³¨è§£å’Œè‡ªåŠ¨CRUDå®ç°

**æ ¸å¿ƒç±»ï¼š**
- `AbstractCrudController` - CRUD ControlleræŠ½è±¡ç±»
- `CrudServiceImpl` - CRUD Serviceå®ç°ç±»
- `@CrudApi` - CRUD APIé…ç½®æ³¨è§£

**å·²åœ¨ continew-admin ä¸­ç»§æ‰¿ä½¿ç”¨ï¼š**
- `BaseController extends AbstractCrudController`
- `BaseServiceImpl extends CrudServiceImpl`

#### 3.3.3 continew-starter-data-mpï¼ˆMyBatis-Plusï¼‰

**åŠŸèƒ½ï¼š** MyBatis-Plus é›†æˆå’Œå¢å¼º

**æä¾›çš„åŠŸèƒ½ï¼š**
- `BaseMapper` - MapperåŸºç±»
- åˆ†é¡µæ’ä»¶è‡ªåŠ¨é…ç½®
- ä¹è§‚é”æ’ä»¶
- é€»è¾‘åˆ é™¤è‡ªåŠ¨å¤„ç†

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```java
// Mapperå±‚
public interface EvaluationTemplateMapper extends BaseMapper<EvaluationTemplateDO> {
    // è‡ªåŠ¨è·å¾—CRUDæ–¹æ³•ï¼š
    // - insert, updateById, deleteById, selectById
    // - selectList, selectPage, selectCount
    // ç­‰ç­‰
}

// Serviceå±‚ä½¿ç”¨
public class EvaluationTemplateServiceImpl extends BaseServiceImpl {
    @Override
    public void create(EvaluationTemplateReq req) {
        EvaluationTemplateDO entity = BeanUtil.copyProperties(req, EvaluationTemplateDO.class);
        baseMapper.insert(entity);  // baseMapper ç»§æ‰¿è‡ª BaseServiceImpl
    }
}
```

#### 3.3.4 continew-starter-auth-satokenï¼ˆæƒé™è®¤è¯ï¼‰

**åŠŸèƒ½ï¼š** Sa-Token é›†æˆ

**æä¾›çš„åŠŸèƒ½ï¼š**
- ç™»å½•è®¤è¯
- æƒé™æ ¡éªŒï¼ˆ`@SaCheckPermission`ï¼‰
- è§’è‰²æ ¡éªŒï¼ˆ`@SaCheckRole`ï¼‰
- Tokenç®¡ç†

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```java
// ç™»å½•
StpUtil.login(userId);

// æƒé™æ ¡éªŒ
@SaCheckPermission("system:user:create")
public void create() { ... }

// è·å–å½“å‰ç”¨æˆ·ID
Long userId = StpUtil.getLoginIdAsLong();

// ç™»å‡º
StpUtil.logout();
```

---

## ğŸ¯ å››ã€å®ç°è¯„ä¼°æ¨¡æ¿ç®¡ç†çš„å»ºè®®

åŸºäºä»¥ä¸Šå°è£…åŠŸèƒ½ï¼Œå®ç°è¯„ä¼°æ¨¡æ¿ç®¡ç†æ¨¡å—æ—¶ï¼š

### å‰ç«¯å¯ç›´æ¥ä½¿ç”¨ï¼š
- âœ… **useDict** - è·å–æ€»åˆ†å­—å…¸æ•°æ®
- âœ… **useTable** - è¡¨æ ¼åˆ—è¡¨ã€åˆ†é¡µã€å¤šé€‰
- âœ… **useDownload** - å¯¼å‡ºåŠŸèƒ½
- âœ… **GiTableã€GiFormã€GiPageLayout** - UIç»„ä»¶

### åç«¯å¯ç›´æ¥ä½¿ç”¨ï¼š
- âœ… **BaseController** - ç®€å•CRUDå¯ç›´æ¥ç»§æ‰¿
- âœ… **@CrudApi** - æ§åˆ¶æ¥å£ç”Ÿæ•ˆèŒƒå›´
- âœ… **Liquibase** - å­—å…¸æ•°æ®é…ç½®
- âœ… **ExcelUtils** - å¯¼å‡ºåŠŸèƒ½ï¼ˆéœ€è‡ªå®šä¹‰æ ·å¼å¤„ç†å™¨ç”¨äºåˆ†ç»„å¯¼å‡ºï¼‰

### éœ€è¦è‡ªå®šä¹‰å®ç°ï¼š
- âŒ åˆ›å»º/æ›´æ–°æ–¹æ³• - æ¶‰åŠå¤šè¡¨äº‹åŠ¡ï¼Œéœ€é‡å†™ `create()` å’Œ `update()`
- âŒ åˆ é™¤æ–¹æ³• - éœ€çº§è”åˆ é™¤è¯„åˆ†é¡¹ï¼Œéœ€é‡å†™ `delete()`
- âŒ è¯¦æƒ…æ–¹æ³• - éœ€åµŒå¥—æŸ¥è¯¢è¯„åˆ†é¡¹ï¼Œéœ€é‡å†™ `get()`
- âŒ å¯¼å‡ºæ–¹æ³• - éœ€è‡ªå®šä¹‰åˆ†ç»„å’Œå°è®¡é€»è¾‘ï¼Œéœ€è‡ªå®šä¹‰å®ç°

---

## ğŸ“š äº”ã€å‚è€ƒèµ„æ–™

- **ContiNew Admin æ–‡æ¡£ï¼š** https://github.com/continew-org/continew-admin
- **ContiNew Starter æ–‡æ¡£ï¼š** https://github.com/continew-org/continew-starter
- **Sa-Token æ–‡æ¡£ï¼š** https://sa-token.cc
- **MyBatis-Plus æ–‡æ¡£ï¼š** https://baomidou.com
- **EasyExcel æ–‡æ¡£ï¼š** https://easyexcel.opensource.alibaba.com

---

**æœ€åæ›´æ–°ï¼š** 2025-12-30
**æ•´ç†äººï¼š** Claude Code Assistant
